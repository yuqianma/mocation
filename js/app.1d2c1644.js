(function(e){function t(t){for(var n,i,s=t[0],c=t[1],u=t[2],p=0,f=[];p<s.length;p++)i=s[p],Object.prototype.hasOwnProperty.call(o,i)&&o[i]&&f.push(o[i][0]),o[i]=0;for(n in c)Object.prototype.hasOwnProperty.call(c,n)&&(e[n]=c[n]);l&&l(t);while(f.length)f.shift()();return a.push.apply(a,u||[]),r()}function r(){for(var e,t=0;t<a.length;t++){for(var r=a[t],n=!0,s=1;s<r.length;s++){var c=r[s];0!==o[c]&&(n=!1)}n&&(a.splice(t--,1),e=i(i.s=r[0]))}return e}var n={},o={app:0},a=[];function i(t){if(n[t])return n[t].exports;var r=n[t]={i:t,l:!1,exports:{}};return e[t].call(r.exports,r,r.exports,i),r.l=!0,r.exports}i.m=e,i.c=n,i.d=function(e,t,r){i.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},i.r=function(e){"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"===typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(i.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)i.d(r,n,function(t){return e[t]}.bind(null,n));return r},i.n=function(e){var t=e&&e.__esModule?function(){return e["default"]}:function(){return e};return i.d(t,"a",t),t},i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.p="/";var s=window["webpackJsonp"]=window["webpackJsonp"]||[],c=s.push.bind(s);s.push=t,s=s.slice();for(var u=0;u<s.length;u++)t(s[u]);var l=c;a.push([0,"chunk-vendors"]),r()})({0:function(e,t,r){e.exports=r("56d7")},"034f":function(e,t,r){"use strict";var n=r("19b3"),o=r.n(n);o.a},"19b3":function(e,t,r){},"2abb":function(e,t,r){"use strict";var n=r("cc27"),o=r.n(n);o.a},"45b8":function(e,t,r){"use strict";var n=r("dd3a"),o=r.n(n);o.a},"56d7":function(e,t,r){"use strict";r.r(t);r("e260"),r("e6cf"),r("cca6"),r("a79d");var n=r("2b0e"),o=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("v-app",{attrs:{id:"app"}},[r("Map"),r("router-view"),r("div",{staticClass:"alert-wrapper"},[r("v-alert",{attrs:{value:e.alertVisible,dismissible:"",transition:"fade-transition",type:"error"},on:{input:e.close}},[e._v(" "+e._s(e.errorMsg&&e.errorMsg.error||e.errorMsg)+" ")])],1)],1)},a=[],i=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("div",{ref:"map",class:e.blur?"blur":"no-blur"})},s=[],c=(r("a4d3"),r("4de4"),r("4160"),r("d81d"),r("fb6a"),r("e439"),r("dbb4"),r("b64b"),r("159b"),r("2fa7")),u=r("595b"),l=r("2f62");function p(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function f(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?p(r,!0).forEach((function(t){Object(c["a"])(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):p(r).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var b={name:"Map",beforeCreate:function(){this.$store.dispatch("fetchPoints")},mounted:function(){var e=this.map=new mapboxgl.Map({container:this.$refs.map,style:"mapbox://styles/mapbox/light-v10"});window._map=e,e.on("load",(function(){e.addSource("line",{type:"geojson",lineMetrics:!0,data:{type:"Feature",properties:{},geometry:{type:"LineString",coordinates:[]}}}),e.addLayer({type:"line",source:"line",id:"line",paint:{"line-color":"red","line-width":5,"line-gradient":["interpolate",["linear"],["line-progress"],0,"blue",.1,"royalblue",.3,"cyan",.5,"lime",.7,"yellow",1,"red"]},layout:{"line-cap":"round","line-join":"round"}})}))},computed:f({},Object(l["d"])(["blur"]),{line:function(){var e=this.$store.state.results;return e.length?u["lineString"](e.map((function(e){var t=e.latlng;return[t.longitude,t.latitude]}))):null},bounds:function(){if(this.line){var e=u["bbox"](this.line);return[e.slice(0,2),e.slice(2)]}}}),watch:{bounds:function(e){e&&e.length&&this.updateMap(e,this.line)}},methods:{updateMap:function(e,t){var r=this.map;r.fitBounds(e,{padding:20,maxZoom:15,animate:!1});var n=r.getSource("line");n?n.setData(t):r.on("load",(function(){r.getSource("line").setData(t)}))}}},d=b,m=(r("2abb"),r("2877")),g=Object(m["a"])(d,i,s,!1,null,"d19b2152",null),h=g.exports,v={components:{Map:h},data:function(){return{alertVisible:!1}},watch:{errorMsg:function(){this.alertVisible=!0}},computed:{errorMsg:function(){return this.$store.state.errorMsg}},methods:{close:function(){this.alertVisible=!1}}},y=v,O=(r("034f"),r("6544")),w=r.n(O),j=r("0798"),P=r("7496"),k=Object(m["a"])(y,o,a,!1,null,null,null),S=k.exports;w()(k,{VAlert:j["a"],VApp:P["a"]});var x=r("8c4f"),D=(r("accc"),r("b0c0"),r("284c")),T=r("5a0c"),V=r.n(T),_=(r("0d03"),r("d3b7"),r("96cf"),r("89ba"));function M(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function C(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?M(r,!0).forEach((function(t){Object(c["a"])(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):M(r).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var E=function(){var e=Object(_["a"])(regeneratorRuntime.mark((function e(t){var r,n,o,a=arguments;return regeneratorRuntime.wrap((function(e){while(1)switch(e.prev=e.next){case 0:return r=a.length>1&&void 0!==a[1]?a[1]:{},r.headers=C({"Content-Type":"application/json","X-LC-Id":"XHtq6Obuh8H3cRMECcVdoDT3-gzGzoHsz","X-LC-Key":"r4wDxAEdcwRyC7RF0Y5KsyTt","X-LC-Session":q.state.user.sessionToken},r.headers),r.data&&(r.body=JSON.stringify(r.data),delete r.data),e.prev=3,e.next=6,fetch("https://mocation.api.hcifun.com/1.1"+t,r);case 6:return n=e.sent,e.next=9,n.json();case 9:if(o=e.sent,!n.ok){e.next=14;break}return e.abrupt("return",o);case 14:throw o;case 15:e.next=20;break;case 17:e.prev=17,e.t0=e["catch"](3),q.commit("setErrorMsg",e.t0);case 20:case"end":return e.stop()}}),e,null,[[3,17]])})));return function(t){return e.apply(this,arguments)}}(),$=(r("99af"),r("a15b"),r("4fad"),r("bf2d")),R=r("e587");function F(e){return Object.entries(e).map((function(e){var t=Object(R["a"])(e,2),r=t[0],n=t[1];return"".concat(r,"=").concat("object"===Object($["a"])(n)?JSON.stringify(n):n)})).join("&")}function B(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:new Date;e=e||t-864e5;var r={where:{time:{$gte:{__type:"Date",iso:new Date(e).toISOString()},$lte:{__type:"Date",iso:new Date(t).toISOString()}}},keys:"latlng,time,s",order:"time",limit:1e3};return E("/classes/Point?".concat(F(r)))}function L(e){return E("/login",{method:"POST",data:e})}function I(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function N(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?I(r,!0).forEach((function(t){Object(c["a"])(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):I(r).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}n["a"].use(l["a"]);var A=V()().add(1,"h").startOf("h"),J=[A.subtract(1,"d"),A],Y=function(e){e.subscribe((function(e){var t=e.type,r=e.payload;"setUser"===t&&window.localStorage.setItem("user",JSON.stringify(r))}))},H=window.localStorage.getItem("user"),X=H?JSON.parse(H):{},q=new l["a"].Store({plugins:[Y],state:{user:N({name:null,sessionToken:null},X),blur:!1,errorMsg:"",dateRange:J.map((function(e){return e.format("YYYY-MM-DD")})),timeFrom:"00:00",timeTo:A.format("HH:mm"),results:[],picking:!1},getters:{range:function(e){var t=e.dateRange,r=e.timeFrom,n=e.timeTo;return[V()(t[0]+" "+r).toISOString(),V()(t[1]+" "+n).toISOString()]}},mutations:{setUser:function(e,t){return e.user=t},setBlur:function(e,t){return e.blur=t},setErrorMsg:function(e,t){return e.errorMsg=t},changeDateRange:function(e,t){return e.dateRange=t},changeTimeFrom:function(e,t){return e.timeFrom=t},changeTimeTo:function(e,t){return e.timeTo=t},setResults:function(e,t){return e.results=t},togglePicker:function(e,t){return e.picking=t}},actions:{fetchPoints:function(e){var t=e.commit,r=e.getters;return B.apply(void 0,Object(D["a"])(r.range)).then((function(e){if(e){var r=e.results,n=void 0===r?[]:r;n.length>1e3?(t("setErrorMsg","too many points"),console.error("too many points:",n)):t("setResults",n)}}))},login:function(e,t){var r=e.commit,n=t.name,o=t.password;return L({username:n,password:o}).then((function(e){var t=e.username,n=e.sessionToken;r("setUser",{name:t,sessionToken:n})}))}},modules:{}}),z=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("Picker")},U=[],K=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("v-container",{class:{"fill-height":e.picking},staticStyle:{"align-items":"flex-start"},attrs:{fluid:""},on:{click:e.handleBlankClick}},[r("v-slide-y-transition",[r("v-card",{directives:[{name:"show",rawName:"v-show",value:e.picking,expression:"picking"}],attrs:{color:"#fff"}},[r("v-date-picker",{attrs:{"no-title":"","full-width":"","show-current":"",range:""},model:{value:e.dateRange,callback:function(t){e.dateRange=t},expression:"dateRange"}}),r("v-slider",{attrs:{"tick-labels":e.ticksLabels,max:24,color:"grey","track-color":"primary",step:"1",ticks:"always","thumb-label":""},model:{value:e.timeFrom,callback:function(t){e.timeFrom=t},expression:"timeFrom"}}),r("v-slider",{attrs:{"tick-labels":e.ticksLabels,max:24,"track-color":"grey",step:"1",ticks:"always","thumb-label":""},model:{value:e.timeTo,callback:function(t){e.timeTo=t},expression:"timeTo"}}),r("v-card-actions",{staticClass:"actions"},[r("v-btn",{attrs:{depressed:"",color:"primary"},on:{click:e.query}},[e._v("Query")])],1)],1)],1),r("v-btn",{directives:[{name:"show",rawName:"v-show",value:!e.picking,expression:"!picking"}],staticClass:"fab",attrs:{absolute:"",fab:"",right:"",color:"primary"},on:{click:e.showPicker}},[r("v-icon",[e._v("mdi-calendar-range")])],1)],1)},G=[];r("4e82"),r("ac1f"),r("1276");function Q(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function Z(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?Q(r,!0).forEach((function(t){Object(c["a"])(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):Q(r).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var W={name:"Picker",data:function(){return{ticksLabels:Object(D["a"])(Array(25)).map((function(e,t){return t%6===0?""+t:""}))}},computed:{picking:function(){return this.$store.state.picking},timeFrom:{get:function(){return this.$store.state.timeFrom.split(":")[0]},set:function(e){this.$store.commit("changeTimeFrom",e+":00")}},timeTo:{get:function(){return this.$store.state.timeTo.split(":")[0]},set:function(e){this.$store.commit("changeTimeTo",e+":00")}},dateRange:{get:function(){return this.$store.state.dateRange},set:function(e){this.$store.commit("changeDateRange",e.sort())}}},methods:Z({},Object(l["c"])(["setBlur","togglePicker"]),{},Object(l["b"])(["fetchPoints"]),{query:function(){this.fetchPoints(),this.hidePicker()},showPicker:function(){this.togglePicker(!0),this.setBlur(!0)},hidePicker:function(){this.togglePicker(!1),this.setBlur(!1)},handleBlankClick:function(e){e.target===e.currentTarget&&this.hidePicker()}})},ee=W,te=(r("45b8"),r("8336")),re=r("b0af"),ne=r("99d9"),oe=r("a523"),ae=r("2e4b"),ie=r("132d"),se=r("0789"),ce=r("ba0d"),ue=Object(m["a"])(ee,K,G,!1,null,"4a44d0c2",null),le=ue.exports;w()(ue,{VBtn:te["a"],VCard:re["a"],VCardActions:ne["a"],VContainer:oe["a"],VDatePicker:ae["a"],VIcon:ie["a"],VSlideYTransition:se["d"],VSlider:ce["a"]});var pe={components:{Picker:le}},fe=pe,be=Object(m["a"])(fe,z,U,!1,null,null,null),de=be.exports,me=function(){var e=this,t=e.$createElement,r=e._self._c||t;return r("v-container",{staticClass:"fill-height",attrs:{fluid:""}},[r("v-row",{attrs:{align:"center",justify:"center"}},[r("v-col",{attrs:{cols:"12",xs:"12",sm:"8",md:"6",lg:"4",xl:"4"}},[r("v-card",{staticClass:"elevation-12"},[r("v-toolbar",{attrs:{color:"primary",dark:"",flat:""}},[r("v-toolbar-title",[e._v("Login")]),r("v-spacer")],1),r("v-card-text",[r("v-form",{attrs:{id:"login"},on:{submit:e.onSubmit}},[r("v-text-field",{attrs:{label:"Name",name:"name","prepend-icon":"person",type:"text"}}),r("v-text-field",{attrs:{label:"Password",name:"password","prepend-icon":"lock",type:"password"}})],1)],1),r("v-card-actions",[r("v-spacer"),r("v-btn",{attrs:{type:"submit",form:"login",color:"primary"}},[e._v("Login")])],1)],1)],1)],1)],1)},ge=[];function he(e,t){var r=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),r.push.apply(r,n)}return r}function ve(e){for(var t=1;t<arguments.length;t++){var r=null!=arguments[t]?arguments[t]:{};t%2?he(r,!0).forEach((function(t){Object(c["a"])(e,t,r[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(r)):he(r).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(r,t))}))}return e}var ye={created:function(){this.setBlur(!0)},beforeDestroy:function(){this.setBlur(!1)},methods:ve({onSubmit:function(e){var t=this;e.preventDefault();var r=e.target.name.value,n=e.target.password.value;this.login({name:r,password:n}).then((function(){t.$router.push({path:"/"})}))}},Object(l["c"])(["setBlur"]),{},Object(l["b"])(["login"]))},Oe=ye,we=r("62ad"),je=r("4bd4"),Pe=r("0fd9"),ke=r("2fa4"),Se=r("8654"),xe=r("71d9"),De=r("2a7f"),Te=Object(m["a"])(Oe,me,ge,!1,null,"83ac6dfe",null),Ve=Te.exports;w()(Te,{VBtn:te["a"],VCard:re["a"],VCardActions:ne["a"],VCardText:ne["b"],VCol:we["a"],VContainer:oe["a"],VForm:je["a"],VRow:Pe["a"],VSpacer:ke["a"],VTextField:Se["a"],VToolbar:xe["a"],VToolbarTitle:De["a"]}),n["a"].use(x["a"]);var _e=[{path:"/login",component:Ve,beforeEnter:function(e,t,r){q.state.user.sessionToken?r({path:"/",replace:!0}):r()}},{path:"/",component:de,beforeEnter:function(e,t,r){q.state.user.sessionToken?r():r({path:"/login",replace:!0})}}],Me=new x["a"]({mode:"history",base:"/",routes:_e}),Ce=Me,Ee=r("f309");n["a"].use(Ee["a"]);var $e=new Ee["a"]({icons:{iconfont:"mdi"}});n["a"].config.productionTip=!1,new n["a"]({router:Ce,store:q,vuetify:$e,render:function(e){return e(S)}}).$mount("#app")},cc27:function(e,t,r){},dd3a:function(e,t,r){}});
//# sourceMappingURL=app.1d2c1644.js.map